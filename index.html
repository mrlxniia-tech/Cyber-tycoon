<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cyber Tycoon V2 FIX</title>
    <style>
        :root { --neon: #00f2ff; --bg: #050508; }
        .theme-flame { --neon: #ff6a00; }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        
        body { 
            background: #050508; color: white; font-family: sans-serif; 
            height: 100vh; display: flex; flex-direction: column; overflow: hidden;
        }

        /* HEADER FIXE */
        #header { height: 60px; background: #111122; border-bottom: 2px solid var(--neon); display: flex; align-items: center; justify-content: center; }
        #money { font-size: 1.8rem; font-weight: bold; color: var(--neon); }

        /* ZONE DE CLIC - ISOLEE POUR EVITER LES BUGS */
        #click-zone { 
            flex: 1; display: flex; align-items: center; justify-content: center; 
            background: radial-gradient(circle, #111 0%, #000 100%);
        }

        #main-btn {
            width: 150px; height: 150px; border-radius: 50%;
            background: linear-gradient(135deg, var(--neon), #0066ff);
            border: 4px solid white; color: white; font-size: 4rem;
            cursor: pointer; box-shadow: 0 0 20px var(--neon);
            display: flex; align-items: center; justify-content: center;
        }

        /* BAS DE L'ECRAN (ONGLETS) */
        #menu-area { height: 40vh; background: #080810; display: flex; flex-direction: column; border-top: 1px solid #333; }
        
        #tabs { display: flex; height: 50px; background: #000; }
        .tab-btn { flex: 1; border: none; background: none; color: #555; font-weight: bold; font-size: 0.7rem; cursor: pointer; }
        .tab-btn.active { color: var(--neon); border-bottom: 2px solid var(--neon); }

        .panel { flex: 1; overflow-y: auto; padding: 15px; display: none; }
        .panel.active { display: block; }

        /* INTERFACE COMMUNE */
        .card { background: #16162d; padding: 10px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #222; }
        .buy-btn { background: var(--neon); color: black; border: none; padding: 8px 12px; border-radius: 5px; font-weight: bold; }
        input { width: 100%; padding: 10px; margin: 10px 0; background: #000; color: #fff; border: 1px solid #333; }
    </style>
</head>
<body id="b">

    <div id="header"><div id="money">0 €</div></div>

    <div id="click-zone">
        <button id="main-btn" onclick="tap()">$</button>
    </div>

    <div id="menu-area">
        <div id="tabs">
            <button class="tab-btn active" onclick="openTab(event, 'shop')">BOUTIQUE</button>
            <button class="tab-btn" onclick="openTab(event, 'top')">CLASSEMENT</button>
            <button class="tab-btn" onclick="openTab(event, 'config')">RÉGLAGES</button>
        </div>

        <div id="shop" class="panel active"></div>
        
        <div id="top" class="panel">
            <h3 style="color:gold; margin-bottom:10px;">TOP PLAYERS</h3>
            <div class="card"><span>Anonymous_99</span><span>1.2M €</span></div>
            <div class="card" style="border-color:var(--neon)"><span id="p-name">Toi</span><span id="p-money">0 €</span></div>
        </div>

        <div id="config" class="panel">
            <h3 style="color:var(--neon)">PARAMÈTRES</h3>
            <label>PSEUDO :</label>
            <input type="text" id="name-in" maxlength="12" onchange="game.name=this.value; draw();">
            
            <button class="buy-btn" style="width:100%; margin-bottom:10px;" onclick="setTheme('flame')">ACTIVER THÈME FLAMME</button>
            <button class="buy-btn" style="width:100%; background:#444; color:white;" onclick="game.sound=!game.sound; this.innerText=game.sound?'SON : ON':'SON : OFF'">SON : ON</button>
            <hr style="margin:15px 0; opacity:0.2;">
            <button class="buy-btn" style="width:100%; background:gold" onclick="window.location.href='mailto:Mrlxniia@gmail.com'">SUPPORT PAR MAIL</button>
        </div>
    </div>

    <script>
        let game = { money: 0, name: "Hacker", theme: "default", sound: true };
        let items = [{n:"Clavier", c:20, p:1, q:0}, {n:"Bot Auto", c:300, p:5, q:0}];

        function tap() {
            let pwr = 1;
            items.forEach(i => { if(i.n=="Clavier") pwr += i.q * i.p; });
            game.money += pwr;
            if(game.sound) beep();
            draw();
        }

        function buy(idx) {
            if(game.money >= items[idx].c) {
                game.money -= items[idx].c;
                items[idx].q++;
                items[idx].c = Math.floor(items[idx].c * 1.6);
                draw();
            }
        }

        function draw() {
            document.getElementById('money').innerText = Math.floor(game.money).toLocaleString() + " €";
            document.getElementById('p-money').innerText = Math.floor(game.money).toLocaleString() + " €";
            document.getElementById('p-name').innerText = game.name;
            
            let html = "";
            items.forEach((it, i) => {
                html += `<div class="card">
                    <span><b>${it.n}</b> (x${it.q})<br><small>${it.c}€</small></span>
                    <button class="buy-btn" onclick="buy(${i})">ACHETER</button>
                </div>`;
            });
            document.getElementById('shop').innerHTML = html;
            save();
        }

        function openTab(e, id) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            e.target.classList.add('active');
        }

        function setTheme(t) { game.theme=t; document.getElementById('b').className="theme-"+t; save(); }

        function beep() {
            try {
                let ctx = new (window.AudioContext || window.webkitAudioContext)();
                let o = ctx.createOscillator(); let g = ctx.createGain();
                o.type="sine"; o.frequency.value=400;
                g.gain.setValueAtTime(0.05, ctx.currentTime);
                g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.1);
                o.connect(g); g.connect(ctx.destination);
                o.start(); o.stop(ctx.currentTime + 0.1);
            } catch(e){}
        }

        function save() { localStorage.setItem('CT_V2_FINAL', JSON.stringify({game, items})); }
        
        window.onload = () => {
            let s = localStorage.getItem('CT_V2_FINAL');
            if(s) {
                let d = JSON.parse(s); game = d.game; items = d.items;
                setTheme(game.theme);
                document.getElementById('name-in').value = game.name;
            }
            draw();
            setInterval(() => {
                items.forEach(it => { if(it.n != "Clavier") game.money += (it.q * it.p)/10; });
                draw();
            }, 100);
        };
    </script>
</body>
</html>
